This is the final version made for python, before a different approach was taken.
